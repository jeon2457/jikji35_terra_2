<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ì—°ë½ë§ ë°ì´í„° ê´€ë¦¬ ë„êµ¬</title>
  <link rel="icon" href="./favicons/favicon-32x32.png?v=2" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      background: #f0f2f5;
      padding: 40px 15px;
      font-family: 'Noto Sans KR', sans-serif;
    }

    .container {
      max-width: 900px;
      background: #fff;
      padding: 30px;
      border-radius: 20px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
    }

    .form-section {
      background: #f8f9fa;
      padding: 20px;
      border-radius: 15px;
      margin-bottom: 30px;
      border: 1px solid #dee2e6;
    }

    .member-item {
      border-bottom: 1px solid #eee;
      padding: 12px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      background: #fff;
      transition: 0.2s;
    }

    .member-item:hover {
      background: #f1f3f5;
    }

    .btn-gen {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      font-weight: 700;
    }

    .btn-gen:hover {
      opacity: 0.9;
      color: white;
    }

    .status-badge {
      font-size: 0.8rem;
      padding: 4px 10px;
      border-radius: 20px;
      background: #eef2ff;
      color: #667eea;
      font-weight: 700;
    }

    .filename-input {
      max-width: 200px;
      display: inline-block;
      font-weight: bold;
      border: 2px solid #667eea;
    }

    .import-section {
      border: 2px dashed #667eea;
      padding: 15px;
      border-radius: 12px;
      margin-bottom: 20px;
      background: #fdfdff;
    }
  </style>
</head>

<body>

  <div class="container">
    <h3 class="text-center mb-4">ğŸ“± ì˜¤í”„ë¼ì¸ ì—°ë½ë§ êµì²´ ê´€ë¦¬ì‹œìŠ¤í…œ</h3>

    <!-- 1. íŒŒì¼ ë¶ˆëŸ¬ì˜¤ê¸° ì„¹ì…˜ -->
    <div class="import-section text-center">
      <h6 class="fw-bold mb-2">ğŸ“‚ ê¸°ì¡´ index.html ë˜ëŠ” index-1.html íŒŒì¼ ë¶ˆëŸ¬ì˜¤ê¸°</h6>
      <p class="text-muted small">ì»´í“¨í„°ì— ìˆëŠ” íŒŒì¼ì„ ì„ íƒí•˜ë©´ ì €ì¥ëœ ëª…ë‹¨ì„ ê°€ì ¸ì˜µë‹ˆë‹¤.</p>
      <input type="file" id="importFile" class="form-control mb-2" accept=".html">
      <button class="btn btn-sm btn-outline-primary" onclick="loadMemberFile()">íŒŒì¼ì—ì„œ ë°ì´í„° ì¶”ì¶œí•˜ê¸°</button>
    </div>

    <!-- 2. ì…ë ¥ í¼ -->
    <div class="form-section">
      <h5 class="mb-3" id="formTitle">â• ìƒˆ íšŒì› ì •ë³´ ì…ë ¥</h5>
      <div class="row g-2">
        <div class="col-md-3"><input type="text" id="newName" class="form-control" placeholder="ì´ë¦„ (í•„ìˆ˜)"></div>
        <div class="col-md-3"><input type="text" id="newTel" class="form-control" placeholder="ì „í™”ë²ˆí˜¸ (í•„ìˆ˜)"></div>
        <div class="col-md-2"><input type="text" id="newAddr" class="form-control" placeholder="ê±°ì£¼ì§€"></div>
        <div class="col-md-2"><input type="text" id="newRemark" class="form-control" placeholder="ë¹„ê³  (íšŒì¥/ì´ë¬´)"></div>
        <div class="col-md-2">
          <button class="btn btn-primary w-100 fw-bold" id="addBtn" onclick="addMember()">ëª…ë‹¨ ì¶”ê°€</button>
        </div>
      </div>
    </div>

    <!-- 3. ëª…ë‹¨ ì¶œë ¥ -->
    <div class="d-flex justify-content-between align-items-center mb-2">
      <h5>ğŸ“„ í˜„ì¬ ëª…ë‹¨ í™•ì¸ (ê°€ë‚˜ë‹¤ìˆœ ìë™ì •ë ¬) <span id="totalCount" class="status-badge"></span></h5>
      <button class="btn btn-sm btn-outline-danger" onclick="resetToOriginal()">ëª©ë¡ ë¹„ìš°ê¸°</button>
    </div>

    <div id="memberList" class="mb-4"
      style="max-height: 400px; overflow-y: auto; border: 1px solid #eee; border-radius: 10px;">
      <!-- ë¦¬ìŠ¤íŠ¸ ìë™ ìƒì„± -->
    </div>

    <!-- 4. íŒŒì¼ëª… ì„ íƒ ë° íŒŒì¼ ìƒì„± -->
    <div class="card p-3 shadow-sm">
      <div class="d-flex align-items-center justify-content-center gap-3 flex-wrap">
        <div class="fw-bold">ì €ì¥í•  íŒŒì¼ ì´ë¦„:</div>
        <input type="text" id="fileName" class="form-control filename-input" value="index.html">
        <button class="btn btn-gen btn-lg px-4" onclick="generateIndexFile()">ğŸš€ íŒŒì¼ ìƒì„± ë° ë‹¤ìš´ë¡œë“œ</button>
      </div>
    </div>

    <div class="alert alert-info mt-4 small">
      <strong>ğŸ’¡ ì•ˆë‚´ì‚¬í•­:</strong><br>
      - [íŒŒì¼ ì„ íƒ] í›„ [ë°ì´í„° ì¶”ì¶œ]ì„ ëˆ„ë¥´ë©´ ê¸°ì¡´ íŒŒì¼ì˜ ëª…ë‹¨ì´ ë¦¬ìŠ¤íŠ¸ì— ë‚˜íƒ€ë‚©ë‹ˆë‹¤.<br>
      - ë¦¬ìŠ¤íŠ¸ì—ì„œ <strong>ìˆ˜ì •</strong>ì„ ëˆ„ë¥´ë©´ ìƒë‹¨ í¼ì—ì„œ ë‚´ìš©ì„ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br>
      - ë¹„ê³ ë€ì— <strong>'íšŒì¥'</strong> ë˜ëŠ” <strong>'ì´ë¬´'</strong>ë¥¼ ì…ë ¥í•˜ë©´ ê±°ì£¼ì§€ í´ë¦­ ì‹œ ë‹¨ì²´ë¬¸ì ë§í¬ê°€ ìë™ ìƒì„±ë©ë‹ˆë‹¤.<br>
      - ğŸ“Œ ìƒì„±ëœ íŒŒì¼(ë‹¤ìš´ë¡œë“œ)ì€ ê¸°ì¡´ index.html ë˜ëŠ” index-1.html íŒŒì¼ê³¼ êµì²´(ë®ì–´ì“°ê¸°) í•´ì£¼ì„¸ìš”.<br>
      - ğŸ“Œ í…Œì´ë¸” ì œëª©ë¶€ë¶„ ë°±ê·¸ë¼ìš´ë“œ ì´ë¯¸ì§€ë³€ê²½ì€ ./css/style.css(178í–‰)ì—ì„œ ìˆ˜ì •
    </div>
  </div>

  <script>
    let members = [];
    let editIndex = -1; // ìˆ˜ì • ì¤‘ì¸ ì¸ë±ìŠ¤ ì¶”ì 

    // ï¿½ ì „í™”ë²ˆí˜¸ ìë™ í•˜ì´í”ˆ ì¶”ê°€ ê¸°ëŠ¥
    document.addEventListener('DOMContentLoaded', function () {
      const telInput = document.getElementById('newTel');

      telInput.addEventListener('input', function (e) {
        let value = e.target.value.replace(/[^0-9]/g, ''); // ìˆ«ìë§Œ ì¶”ì¶œ
        let formattedValue = '';

        if (value.length <= 3) {
          formattedValue = value;
        } else if (value.length <= 7) {
          formattedValue = value.slice(0, 3) + '-' + value.slice(3);
        } else if (value.length <= 11) {
          formattedValue = value.slice(0, 3) + '-' + value.slice(3, 7) + '-' + value.slice(7);
        } else {
          formattedValue = value.slice(0, 3) + '-' + value.slice(3, 7) + '-' + value.slice(7, 11);
        }

        e.target.value = formattedValue;
      });
    });

    // ï¿½ğŸ“‚ íŒŒì¼ ë¶ˆëŸ¬ì˜¤ê¸° ë° ë°ì´í„° íŒŒì‹±
    function loadMemberFile() {
      const fileInput = document.getElementById('importFile');
      if (!fileInput.files[0]) { alert('íŒŒì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”.'); return; }

      const file = fileInput.files[0];
      const reader = new FileReader();

      reader.onload = function (e) {
        const htmlContent = e.target.result;
        const parser = new DOMParser();
        const doc = parser.parseFromString(htmlContent, 'text/html');
        const rows = doc.querySelectorAll('tbody tr');

        if (rows.length === 0) {
          alert('ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì˜¬ë°”ë¥¸ ì—°ë½ë§ íŒŒì¼ì¸ì§€ í™•ì¸í•˜ì„¸ìš”.');
          return;
        }

        const extractedMembers = [];
        rows.forEach(row => {
          const cells = row.querySelectorAll('td');
          if (cells.length >= 5) {
            extractedMembers.push({
              name: cells[1].innerText.trim(),
              tel: cells[2].innerText.trim(),
              addr: cells[3].innerText.trim(),
              remark: cells[4].innerText.trim().replace(/\u00a0/g, '') // ë¹„ì–´ìˆëŠ” &nbsp; ì œê±°
            });
          }
        });

        members = extractedMembers;
        editIndex = -1; // ì¶”ì¶œ ì‹œ ìˆ˜ì • ëª¨ë“œ ì´ˆê¸°í™”
        renderList();
        alert(members.length + 'ëª…ì˜ ë°ì´í„°ë¥¼ ì„±ê³µì ìœ¼ë¡œ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤.');
      };

      reader.readAsText(file, 'utf-8');
    }

    function renderList() {
      // ìˆ˜ì • ì¤‘ì´ ì•„ë‹ ë•Œë§Œ ì •ë ¬ (ìˆ˜ì • ì¤‘ ì •ë ¬í•˜ë©´ ì¸ë±ìŠ¤ ê¼¬ì„ ë°©ì§€)
      if (editIndex === -1) {
        members.sort((a, b) => a.name.localeCompare(b.name, 'ko'));
      }

      const listArea = document.getElementById('memberList');
      const countArea = document.getElementById('totalCount');
      listArea.innerHTML = '';
      countArea.innerText = `ì´ ${members.length}ëª…`;

      members.forEach((m, index) => {
        const div = document.createElement('div');
        div.className = 'member-item';
        div.innerHTML = `
        <div><strong>${index + 1}. ${m.name}</strong> <span class="text-muted">(${m.tel})</span></div>
        <div>
          <span class="badge bg-light text-dark me-2">${m.addr} / ${m.remark || '-'}</span>
          <button class="btn btn-sm btn-outline-primary me-1" onclick="prepareEdit(${index})">ìˆ˜ì •</button>
          <button class="btn btn-sm btn-outline-danger" onclick="deleteMember(${index})">ì‚­ì œ</button>
        </div>`;
        listArea.appendChild(div);
      });
    }

    // âœï¸ ìˆ˜ì •ì„ ìœ„í•´ ì…ë ¥ í¼ì— ë°ì´í„° ë¡œë“œ
    function prepareEdit(index) {
      const m = members[index];
      document.getElementById('newName').value = m.name;
      document.getElementById('newTel').value = m.tel;
      document.getElementById('newAddr').value = m.addr;
      document.getElementById('newRemark').value = m.remark;

      editIndex = index;
      document.getElementById('formTitle').innerText = "ğŸ“ íšŒì› ì •ë³´ ìˆ˜ì •";
      document.getElementById('addBtn').innerText = "ìˆ˜ì • ì™„ë£Œ";
      document.getElementById('addBtn').classList.replace('btn-primary', 'btn-success');

      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    function addMember() {
      const name = document.getElementById('newName').value.trim();
      const tel = document.getElementById('newTel').value.trim();
      const addr = document.getElementById('newAddr').value.trim();
      const remark = document.getElementById('newRemark').value.trim();

      if (!name || !tel) { alert('ì´ë¦„ê³¼ ì „í™”ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”.'); return; }

      if (editIndex > -1) {
        // ìˆ˜ì • ì²˜ë¦¬
        members[editIndex] = { name, tel, addr, remark };
        editIndex = -1;
        document.getElementById('formTitle').innerText = "â• ìƒˆ íšŒì› ì •ë³´ ì…ë ¥";
        document.getElementById('addBtn').innerText = "ëª…ë‹¨ ì¶”ê°€";
        document.getElementById('addBtn').classList.replace('btn-success', 'btn-primary');
      } else {
        // ì‹ ê·œ ì¶”ê°€
        members.push({ name, tel, addr, remark });
      }

      renderList();
      document.getElementById('newName').value = ''; document.getElementById('newTel').value = '';
      document.getElementById('newAddr').value = ''; document.getElementById('newRemark').value = '';
    }

    function deleteMember(index) {
      if (confirm('ì œì™¸í• ê¹Œìš”?')) {
        members.splice(index, 1);
        editIndex = -1; // ì‚­ì œ ì‹œ ìˆ˜ì • ëª¨ë“œ í•´ì œ
        renderList();
      }
    }

    function resetToOriginal() { if (confirm('ëª©ë¡ì„ ëª¨ë‘ ë¹„ìš¸ê¹Œìš”?')) { members = []; editIndex = -1; renderList(); } }

    // ğŸš€ íŒŒì¼ ìƒì„±
    function generateIndexFile() {
      const saveName = document.getElementById('fileName').value.trim() || 'index.html';
      members.sort((a, b) => a.name.localeCompare(b.name, 'ko'));

      let rowsHTML = '';
      members.forEach((m, i) => {
        const isLeader = m.remark.includes('íšŒì¥') || m.remark.includes('ì´ë¬´');
        let addressContent = `<span>${m.addr}</span>`;

        if (isLeader) {
          const othersTel = members
            .filter(other => other.tel !== m.tel)
            .map(other => other.tel.replace(/[^0-9]/g, ''))
            .join(',');
          addressContent = `<a href="sms:${othersTel}" onclick="sendSMS(event,'${othersTel}')"><span>${m.addr}</span></a>`;
        }

        rowsHTML += `
            <tr>
              <td class="no_1">${i + 1}</td>
              <td class="name_1">
                <a href="tel:${m.tel}"><span>${m.name}</span></a>
              </td>
              <td class="tel_1">
                <a href="tel:${m.tel}"><span>${m.tel}</span></a>
              </td>
              <td class="address_1">${addressContent}</td>
              <td class="remark_1"><span>${m.remark || '&nbsp;'}</span></td>
              <td class="sms_1">
                <a href="sms:${m.tel}" onclick="sendSMS(event,'${m.tel}')"><span><img class="max-small" src="image/sms-4.png" /></span></a>
              </td>
            </tr>`;
      });

      const finalHTML = `<!DOCTYPE html>
<html lang="ko">
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="description" content="ì§ì§€í™©ì•…íšŒ35" />
  <title>ì§ì§€35ì—°ë½ë§</title>
  <meta name="format-detection" content="telephone=no" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="css/style.css" />
  <link rel="icon" href="./favicons/favicon-32x32.png?v=2" />
  <link rel="manifest" href="./manifest.json" />
  <meta name="theme-color" content="#ffffff" />
  <script type="text/javascript">
    document.oncontextmenu = function () { return false; };
    window.onload = () => {
      let deg = 0;
      const cube = document.querySelector('.cube');
      if (cube) { setInterval(() => { deg -= 90; cube.style.transform = "rotateX(" + deg + "deg)"; }, 1000); }
      let lastTimeString = '';
      function updateClock() {
        var date = new Date();
        var YYYY = String(date.getFullYear());
        var MM = String(date.getMonth() + 1).padStart(2, '0');
        var DD = String(date.getDate()).padStart(2, '0');
        var hh = String(date.getHours()).padStart(2, '0');
        var mm = String(date.getMinutes()).padStart(2, '0');
        var week = ['ì¼', 'ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ', 'í† '][date.getDay()];
        const currentTimeString = YYYY + "/" + MM + "/" + DD + "(" + week + ") " + hh + ":" + mm;
        if (currentTimeString !== lastTimeString) {
          var Clockday = document.getElementById('Clockday');
          var Clock = document.getElementById('Clock');
          if (Clockday) Clockday.innerText = YYYY + "/" + MM + "/" + DD + "(" + week + ")";
          if (Clock) Clock.innerText = hh + ":" + mm;
          lastTimeString = currentTimeString;
        }
      }
      setInterval(updateClock, 1000);
      updateClock();
      setTimeout(() => {
        document.getElementById('loading-screen').style.opacity = '0';
        setTimeout(() => {
          document.getElementById('loading-screen').style.display = 'none';
          document.getElementById('main-content').style.display = 'block';
        }, 700);
      }, 800);
    };
    function sendSMS(e, n) { return true; }
  <\/script>
</head>
<body>
  <div id="loading-screen"><img src="image/jikji35-1.jpg" alt="ì§ì§€í™©ì•…íšŒ" /></div>
  <div id="main-content">
    <div class="container">
      <div class="header">
        <div id="Clockday">00:00</div>
        <div id="Clock">00/00/00</div>
      </div>
      <div class="main-body">
        <div class="content-wrapper">
          <div class="wrap2">
            <div class="cube-container">
              <div class="wrap1">
                <div class="cube">
                  <img src="./image/mail_1.png" /><img src="./image/chat_1.png" />
                  <img src="./image/phone_1.png" /><img src="./image/sms_1.png" />
                </div>
              </div>
            </div>
            <div class="marquee-container">
              <div class="marquee">
                <img src="image/aa.gif" width="25px" height="25px" border="0" />
                <img src="image/dd.gif" width="25px" height="25px" border="0" />
                <span class="custom-span">ì§ì§€ì´ˆ35íšŒ ê¹€ì²œì§€ë¶€ ë™ê¸°ì—°ë½ë§</span>
                <img src="image/dd.gif" width="25px" height="25px" border="0" />
                <img src="image/aa.gif" width="25px" height="25px" border="0" />
              </div>
            </div>
          </div>
        </div>
        <table>
          <thead>
            <tr><th class="no"><span>NO</span></th><th class="name"><span>ì´ë¦„</span></th><th class="tel"><span>ì „í™”ë²ˆí˜¸</span></th><th class="address"><span>ê±°ì£¼ì§€</span></th><th class="remark"><span>ë¹„ê³ </span></th><th class="sms"><span>SMS</span></th></tr>
          </thead>
          <tbody>
            ${rowsHTML}
          </tbody>
          <tfoot>
            <tr>
              <td colspan="6">
                <div class="gototop">
                  <button id="goTopBtn" type="button" aria-label="TOP" style="background:none; border:none; cursor:pointer;">
                    <img class="fa" src="image/arrow.png" alt="TOP" />
                  </button>
                </div>
                <div class="foot">
                  <img src="image/anicircle03_green.gif" />&nbsp;&nbsp;
                  <span class="jik"><a href="./book/index.html" target="_blank">https://terraone-d0318.web.app/login.html</a></span>&nbsp;
                  <img src="image/anicircle03_green.gif" />
                </div>
              </td>
            </tr>
          </tfoot>
        </table>
      </div>
    </div>
  </div>
  <script>
    document.getElementById("goTopBtn").addEventListener("click", function () { window.scrollTo({ top: 0, behavior: 'smooth' }); });
  <\/script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"><\/script>
</body>
</html>`;

      const blob = new Blob([finalHTML], { type: 'text/html' });
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob);
      a.download = saveName;
      a.click();
      URL.revokeObjectURL(a.href);
    }
  </script>
</body>

</html>